name: "Nomamesec deploy to EKS"
on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
- name: Deploy Helm
  uses: bitovi/github-actions-deploy-eks-helm@v1.2.8
  with:
    aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
    aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    aws-region: us-west-2
    cluster-name: mycluster
    cluster-role-arn: ${{ secrets.AWS_ROLE_ARN }}
    config-files: fluent-bit/prod/values.yaml
    chart-path: fluent/fluent-bit
    namespace: logging
    name: fluent-bit
    chart-repository: https://fluent.github.io/helm-charts
    version: 0.20.6
    atomic: true

